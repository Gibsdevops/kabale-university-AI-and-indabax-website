{% extends "layouts/base.html" %}
{% load static %}

{% block title %}{{ page.title }} - {{ site_name }}{% endblock %}

{% block content %}
<style>
    * {
        box-sizing: border-box;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        line-height: 1.6;
        color: #2c3e50;
    }

    .research-hero {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 80px 0 60px;
        position: relative;
        overflow: hidden;
    }

    .research-hero::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
        opacity: 0.3;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        position: relative;
        z-index: 1;
    }

    .research-hero h1 {
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 20px;
        line-height: 1.2;
    }

    .research-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 30px;
        margin-bottom: 30px;
        opacity: 0.9;
    }

    .meta-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.95rem;
    }

    .meta-icon {
        width: 18px;
        height: 18px;
        opacity: 0.8;
    }

    .research-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 20px;
    }

    .tag {
        background: rgba(255, 255, 255, 0.2);
        color: white;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 500;
        backdrop-filter: blur(10px);
    }

    .research-content {
        padding: 60px 0;
    }

    .content-grid {
        display: grid;
        grid-template-columns: 1fr 300px;
        gap: 60px;
        margin-top: 40px;
    }

    .main-content {
        background: white;
    }

    .research-image {
        width: 100%;
        height: 400px;
        object-fit: cover;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        margin-bottom: 40px;
    }

    .abstract {
        background: #f8fafc;
        border-left: 4px solid #667eea;
        padding: 30px;
        border-radius: 8px;
        margin-bottom: 40px;
        font-size: 1.1rem;
        line-height: 1.7;
    }

    .abstract h3 {
        color: #667eea;
        margin-bottom: 15px;
        font-size: 1.2rem;
    }

    .content-section {
        margin-bottom: 40px;
    }

    .content-section h2 {
        color: #2c3e50;
        font-size: 1.6rem;
        margin-bottom: 20px;
        border-bottom: 2px solid #e2e8f0;
        padding-bottom: 10px;
    }

    .content-section p {
        margin-bottom: 20px;
        font-size: 1.05rem;
        line-height: 1.7;
    }

    .sidebar {
        background: white;
        position: sticky;
        top: 20px;
        height: fit-content;
    }

    .sidebar-card {
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 25px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    .sidebar-card h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 1.1rem;
    }

    .researcher-item {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 15px;
    }

    .researcher-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(45deg, #667eea, #764ba2);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 0.9rem;
    }

    .researcher-info h4 {
        font-size: 0.95rem;
        margin-bottom: 2px;
    }

    .researcher-info p {
        font-size: 0.8rem;
        color: #64748b;
        margin: 0;
    }

    .download-btn {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 12px 24px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .download-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        color: white;
        text-decoration: none;
    }

    .metrics-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-top: 20px;
    }

    .metric-item {
        text-align: center;
        padding: 15px;
        background: #f8fafc;
        border-radius: 8px;
    }

    .metric-value {
        display: block;
        font-size: 1.5rem;
        font-weight: bold;
        color: #667eea;
    }

    .metric-label {
        font-size: 0.8rem;
        color: #64748b;
        margin-top: 5px;
    }

    .citation-box {
        background: #f1f5f9;
        border: 1px solid #cbd5e1;
        border-radius: 8px;
        padding: 20px;
        font-family: 'Courier New', monospace;
        font-size: 0.85rem;
        line-height: 1.5;
        color: #475569;
        word-break: break-all;
    }

    .no-content {
        text-align: center;
        padding: 60px 20px;
        color: #64748b;
        font-style: italic;
    }

    @media (max-width: 968px) {
        .content-grid {
            grid-template-columns: 1fr;
            gap: 40px;
        }
        
        .research-hero h1 {
            font-size: 2.2rem;
        }
        
        .research-meta {
            flex-direction: column;
            gap: 15px;
        }
    }

    @media (max-width: 640px) {
        .research-hero {
            padding: 60px 0 40px;
        }
        
        .research-hero h1 {
            font-size: 1.8rem;
        }
        
        .container {
            padding: 0 15px;
        }
    }
</style>


<!-- Research Hero Section -->
<div class="research-hero">
    <div class="container">
        <h1>{{ page.title }}</h1>
        
        <div class="research-meta">
            {% if page.publish_date %}
            <div class="meta-item">
                <svg class="meta-icon" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd" />
                </svg>
                <span>Published: {{ page.publish_date|date:"F j, Y" }}</span>
            </div>
            {% endif %}
            
            {% if page.category %}
            <div class="meta-item">
                <svg class="meta-icon" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 01-1.447.894L12 15.382l-2.553 1.512A1 1 0 018 16V4z" clip-rule="evenodd" />
                </svg>
                <span>{{ page.category }}</span>
            </div>
            {% endif %}
            
            {% if page.institution %}
            <div class="meta-item">
                <svg class="meta-icon" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10.496 2.132a1 1 0 00-.992 0l-7 4A1 1 0 003 8v7a1 1 0 100 2h14a1 1 0 100-2V8a1 1 0 00.496-1.868l-7-4zM6 9a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1z" clip-rule="evenodd" />
                </svg>
                <span>{{ page.institution }}</span>
            </div>
            {% endif %}
        </div>
        
        {% if category_list %}
        <div class="research-tags">
            {% for tag in category_list %}
                <span class="tag">{{ tag }}</span>
            {% endfor %}
        </div>
        {% endif %}
    </div>
</div>

<!-- Main Content -->
<div class="research-content">
    <div class="container">
        <div class="content-grid">
            <div class="main-content">
                {% if page.image %}
                    <img src="{{ page.image.url }}" alt="{{ page.title }}" class="research-image">
                {% endif %}
                
                {% if page.summary %}
                <div class="abstract">
                    <h3>Abstract</h3>
                    <p>{{ page.summary }}</p>
                </div>
                {% endif %}

                {% if page.content %}
                <div class="content-section">
                    {{ page.content|safe }}
                </div>
                {% else %}
                <div class="no-content">
                    <p>No detailed content available for this research.</p>
                </div>
                {% endif %}
            </div>

            <div class="sidebar">
                {% if researchers_list %}
                <div class="sidebar-card">
                    <h3>Researchers</h3>
                    {% for researcher in researchers_list %}
                    <div class="researcher-item">
                        <div class="researcher-avatar">
                            {{ researcher|slice:":2"|upper }}
                        </div>
                        <div class="researcher-info">
                            <h4>{{ researcher }}</h4>
                            <p>Researcher</p>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}

                <div class="sidebar-card">
                    <h3>Research Details</h3>
                    <div class="metrics-grid">
                        {% if page.category %}
                        <div class="metric-item">
                            <span class="metric-value">{{ page.category|truncatechars:8 }}</span>
                            <div class="metric-label">Category</div>
                        </div>
                        {% endif %}
                        
                        <div class="metric-item">
                            <span class="metric-value">{{ page.publish_date|date:"Y" }}</span>
                            <div class="metric-label">Year</div>
                        </div>
                        
                        {% if page.institution %}
                        <div class="metric-item">
                            <span class="metric-value">{{ page.institution|truncatechars:8 }}</span>
                            <div class="metric-label">Institution</div>
                        </div>
                        {% endif %}
                        
                        <div class="metric-item">
                            <span class="metric-value">{{ page.updated_at|date:"M j" }}</span>
                            <div class="metric-label">Updated</div>
                        </div>
                    </div>
                </div>

                {% if page.document_url %}
                <div class="sidebar-card">
                    <h3>Access Research</h3>
                    <a href="{{ page.document_url }}" target="_blank" class="download-btn">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
                        </svg>
                        View Document
                    </a>
                </div>
                {% endif %}

                <div class="sidebar-card">
                    <h3>Citation</h3>
                    <div class="citation-box">
@article
{% if researchers_list %}
{{ researchers_list.0|lower|slugify }}
{% else %}
research
{% endif %}
{{ page.publish_date|date:"Y" }},<br>
&nbsp;&nbsp;title={{ page.title }},<br>
{% if researchers_list %}&nbsp;&nbsp;author={{ page.researchers }},<br>{% endif %}
{% if page.institution %}&nbsp;&nbsp;institution={{ page.institution }},<br>{% endif %}
&nbsp;&nbsp;year={{ page.publish_date|date:"Y" }}<br>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% include 'layouts/footer.html' %}
